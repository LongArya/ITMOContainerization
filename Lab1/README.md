# Отчет по первой лабораторной 

## Запуск 

В первой лабораторной контейнеризован сервис jupyterhub

```bash
cd Lab1
# bad osne 
# build 
docker build -t bad_jupyterhub -f ./bad_Dockerfile .
# run 
docker run -d -p 8000:8000 -v ./dummy_volume:/jupyterhub/mount:rw bad_jupyterhub

# good one 
# build 
docker build -t good_jupyterhub -f ./good_Dockerfile .
# run 
docker run -d -p 8000:8000 -v ./dummy_volume:/jupyterhub/mount:rw good_jupyterhub

```

## Проверка volume 

```bash
docker exec $(CONTAINER_ID) cat /jupyterhub/mount/file.txt 
>>> mounted!
```


## Bad Dockefile practices 

1.  Неоптимальный базовый Docker образ 

В плохом Dockerfile используется базовый образ с python3.8 на который вручную ставится jupyterhub, вместо использования базового образа где он уже предустановлен  

2. Чрезмерное число слоев  

В плохом Dockerfile можно сократить число слоев, если сгруппировать установку зависимостей в одну RUN команду 

3. Неоптимальный порядок слоев для переиспользования кеша  

Так как слои кешируются и инвалидация кеша слоя вынуждает пересобирать все последующие слои, то имеет смысл ставить слои которые будут изменяться чаще всего в конец. Например, в плохом Dockerfile копирование данных репозитория происходит перед установкой системных зависимостей, таким образом любое изменение файла в репозитории (что будет просходить часто) приведет к тому что нужно будет заново ставить системные пакеты. В хорошем Dockerfile копирование данных перемещено в конец.

## Bad containerization practices

1. Установка в контейнер лишних зависимостей не нужных для запуска процесса, ради которого был создан контейнер.  

2. Хранить данные в контейнере. Контейнеры по дизайну stateless и подразумевают возможность быть в любой момент остановленными/замененными, поэтому использование их как персистентного хранилища перекрывает их преимущества.  